{"type":"article_comment","id":357006,"parentType":"article","parentId":18122,"uid":18160,"contents":"Tor节点选择代码 笔记<br>\n首先Tor环路 需要3个节点<br>\n入口节点【Guard】，中间节点，出口节点<br>\n分别调用以下3个函数<br>\nchoose_good_entry_server<br>\nchoose_good_middle_server<br>\nchoose_good_exit_server<br>\n<br>\n<br>\n<br>\ntor代码，阅读顺序，从main函数读起<br>\ntor_run_main<br>\nsubsystems_init 这个是重点！！！<br>\n因为 subsystems_init_upto 调用了 r = sys-&gt;initialize();函数指针 指向 subsys_mainloop_initialize，调用了 initialize_periodic_events，<br>\nperiodic_events_register，注册了<br>\n&nbsp; /* This is a legacy catch-all callback that runs once per second if<br>\n&nbsp; * we are online and active. */<br>\n&nbsp; CALLBACK(second_elapsed, NET_PARTICIPANT,<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FL(RUN_ON_DISABLE)),<br>\n<br>\n<br>\n所以 调用了second_elapsed_callback<br>\n通过 circuit_predict_and_launch_new 建立环路~","date":"2020-04-23","agreeCount":1,"discussionCount":0}