{"type":"article_comment","id":401335,"parentType":"article","parentId":19891,"uid":18160,"contents":"小丑鱼架构模型：<br>\n简介：小丑鱼是一种<b>可以改变性别</b>的鱼。<br>\n正常情况下，一个小丑鱼的鱼群里有雄鱼和雌鱼。<br>\n如果这群鱼里，<b>只有雄鱼</b>！<b>那么神奇的事情发生了</b>！<br>\n雄鱼们会开始选举，<b>选举它们中的一条鱼变成雌鱼</b>！<br>\n<br>\nnginx的架构模型就是小丑鱼！<br>\n正常情况下，nginx有一个master进程和n个worker进程。<br>\nworker进程，都是具体干活的，死了一个也不会导致nginx服务出现中断，因为还有其他的worker进程继续工作。<b>而且master进程，就像雌鱼，会生孩子</b>！会自己重新fork一个worker进程。。。。<br>\n<br>\n如果挂掉的是master进程，那么就会在存活的worker进程里，选举一个成为master进程，然后就继续稳定提供服务，百分百完备的不会中断服务！<br>\n<br>\n<br>\n<br>\n总结：<br>\n1.如果是worker进程挂了，其他worker会分担它的工作，master进程会fork新的worker顶替它。<br>\n2.如果是master进程挂了，worker进程会选举一个成为新的master，然后新的master会fork一个新的worker。<br>\n<br>\nmaster就是 雌性的小丑鱼，可以生孩子。<br>\nworker就是 雄性的小丑鱼，雌鱼死了，会被选举成心的雌鱼！","date":"2020-06-03","agreeCount":1,"discussionCount":0}