{"type":"article_comment","id":297163,"parentType":"article","parentId":15493,"uid":20551,"contents":"nginx配置文件（带log）<br>\n<pre><br>\n<br>\n<br>\nserver {<br>\n    ### 1:<br>\n    server_name ●●●●●●●●●●●●;<br>\n<br>\n    listen 80;<br>\n    rewrite ^(.*) https://$server_name$1 permanent;<br>\n    if ($request_method  !~ ^(POST|GET)$) { return  501; }<br>\n    autoindex off;<br>\n    server_tokens off;<br>\n}<br>\n<br>\nserver {<br>\n    ### 2:<br>\n    ssl_certificate /etc/letsencrypt/live/●●●●●●●●●●●●/fullchain.pem;<br>\n<br>\n    ### 3:<br>\n    ssl_certificate_key /etc/letsencrypt/live/●●●●●●●●●●●●/privkey.pem;<br>\n<br>\n    ### 4:<br>\n    location /★★★★★★★★★★★★<br>\n    {<br>\n        proxy_pass http://127.0.0.1:8964;<br>\n        proxy_redirect off;<br>\n<br>\n        proxy_http_version 1.1;<br>\n        proxy_set_header Upgrade $http_upgrade;<br>\n        proxy_set_header Connection \"upgrade\";<br>\n        proxy_set_header Host $host;<br>\n<br>\n        tcp_nodelay on;<br>\n        keepalive_requests 25600;<br>\n        keepalive_timeout 3600 3600;<br>\n        proxy_buffering off;<br>\n        proxy_buffer_size 8k;<br>\n    }<br>\n<br>\n    listen 443 ssl http2;<br>\n    server_name $server_name;<br>\n    charset utf-8;<br>\n<br>\n    tcp_nodelay on;<br>\n    keepalive_timeout 3600 3600;<br>\n<br>\n    ssl_protocols TLSv1.2;<br>\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK;<br>\n    ssl_prefer_server_ciphers on;<br>\n<br>\n    ssl_session_cache shared:SSL:60m;<br>\n    ssl_session_timeout 1d;<br>\n    ssl_session_tickets off;<br>\n<br>\n    ssl_stapling on;<br>\n    ssl_stapling_verify on;<br>\n    resolver 8.8.8.8 8.8.4.4 valid=300s;<br>\n    resolver_timeout 10s;<br>\n<br>\n    # Security settings<br>\n    if ($request_method  !~ ^(POST|GET)$) { return 501; }<br>\n    add_header X-Frame-Options DENY;<br>\n    add_header X-XSS-Protection \"1; mode=block\";<br>\n    add_header X-Content-Type-Options nosniff;<br>\n    add_header Strict-Transport-Security max-age=31536000 always;<br>\n    autoindex off;<br>\n    server_tokens off;<br>\n<br>\n    # 新增<br>\n    access_log /var/log/nginx/nginx_access.log;<br>\n    error_log /var/log/nginx/nginx_error.log;<br>\n<br>\n    index index.html index.htm index.php;<br>\n    root /usr/share/nginx/html;<br>\n    location ~ .*\\.(js|jpg|JPG|jpeg|JPEG|css|bmp|gif|GIF|png)$ { access_log off; }<br>\n}<br>\n</pre>","date":"2020-03-14","agreeCount":2,"discussionCount":0}