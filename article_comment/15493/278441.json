{"type":"article_comment","id":278441,"parentType":"article","parentId":15493,"uid":20551,"contents":"<blockquote>感觉比白话文教程还要亲民。大神有时间可以出一篇trojan的 </blockquote><br>\n其实搭建trojan已经有人写过非常详细的教程了：<br>\n（外链注意）https://trojan-tutor.github.io/2019/04/10/p41.html<br>\n<br>\n简单来说，Trojan相当于Socks6 over TLS （对，是socks6）。为了防止主动探测，它在socks协议的头部加了一段hash，如果hash和预设的认证信息对不上，就转发给http服务器。因此在墙看来，Trojan服务器的行为和https服务器是完全一样的。<br>\n<br>\nTrojan的优点是建立连接延迟小。数据包从客户端到服务器走一个往返，就叫一个RTT。对于一台设在美国的翻墙代理，数据包从中国到美国一个往返，至少需要150+ms。如果协议设计不合理，需要多个RTT建立连接，延迟就非常高。Trojan的握手数据包里夹带应用层数据，因此Trojan建立连接只需要一次TLS1.3握手，再算上TCP握手，Trojan建立连接只需要2个RTT。<br>\n<br>\nTrojan的缺点是不支持CDN。几乎所有的免费CDN服务都不支持自定义应用层协议，只有CDN支持的协议（http1.1，websocket）才可以用CDN反代。Trojan可以看作一种特殊的socks协议，因此不能穿过CDN。<br>\n<br>\n这里多说一句，vmess+http2+tls这种搭配用CDN反代，性能（可能）会下降。即使如cloudflare，截至目前也不是100%支持http2的。从CDN到源服务器那一段会走http1.1，可能会导致性能下降。","date":"2020-03-02","agreeCount":7,"discussionCount":0}