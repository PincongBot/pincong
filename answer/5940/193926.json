{"type":"answer","id":193926,"parentType":"question","parentId":5940,"uid":36917,"contents":"以前大学做过嵌入式，讨论一下这个话题。<br>\n1. 硬件后门：单纯在硬件中植入后门较困难，因为电路板上不会给额外的芯片留位置；低频信号一般都需要配合大量分析，而后门芯片供电一般受限；高频信号又易受干扰，容易导致被植入的设备故障。但如果硬件集成度不够高，配合软件，难度会下降很多，比如将耳机接口飞线至soc调试接口，就可以采集设备上大部分信息，而且配合使用的软件不一定需要特别的权限或漏洞，完全可以通过微信/支付宝的热修补下发。<br>\n2. 软件后门：软件后门难度低于硬件但容易清除。另外在相对封闭的手机上，植入木马可能要借助漏洞，挖漏洞也需要时间和经费。<br>\n<br>\n给手机/电脑植入隐蔽后门的一些思路：<br>\n1. 手机：手机的硬件高度集成化，植入软件后门较有可行性。既然都被喝茶了，想必使用的手机不是国产的（国产手机大概率自带后门，不用重复植入）。<br>\n&nbsp; a. iPhone。没用过，不了解，不好具体评论。其系统软件的安全性依赖于封闭生态。但因为iPhone型号不多，市场占有率较高，政府很可能掌握一些0day，能够植入后门。<br>\n&nbsp; b. Android。许多厂商自行定制系统，安全性参差不起。Pixel系列高版本原生系统未root更新到位的情况下，安全性能够达到iPhone的水平。其他品牌有些会给系统添油加醋，但工程水平不够，代码质量低下；也有一些型号使用的硬件驱动包含漏洞；总体来说，安全性堪忧。假若设备的安全逻辑没有问题，也没有任何已知漏洞，植入思路主要如下：<br>\n&nbsp; &nbsp; 1) 如果没有root，考虑植入系统内核。大部分型号要求解锁固件才能重刷固件，但解锁意味着放弃一些功能，所以用户很可能不会重刷固件。不使用漏洞、不软件解锁的植入过程为：开盖、拆flash、重刷kernel分区和简单修改的bootloader、装flash、组装。只要后门软件质量达标，并且用户不会尝试解锁，后门可以一直保活，并且能够联网升级。<br>\n&nbsp; &nbsp; 2) 通用方法，植入bootloader。如果后门质量达标，唯一的清除方法是拆下flash重新烧录，意味着即使用户送修也不一定能清除掉。但准备带后门的bootloader较耗费资源。<br>\n&nbsp; c. 功能机。相对智能机来说非常简单，但也需要专业知识和时间，并且针对每个个例使用的方法不尽相同。每一例植入的成本应该不高。<br>\n2. 电脑：植入硬件成本不高，使用软件后门也相当可行。<br>\n&nbsp; a. 硬件后门。可以考虑替换设备中的可替换部件，比如换掉原来的无线网卡，通过PCI-E接口可以读写系统内存（一般系统不开启IOMMU）。也可以在形状上仿照电脑配件，只使用设备的电源，独立于设备运作。<br>\n&nbsp; b. 软件后门。电脑上能够长期存储的不止硬盘。可以尝试在厂家的BIOS固件中植入木马，如果质量达标，唯一的清除方式是拆下flash重新刷入固件。也可以尝试感染GPU或其他具有运算能力、能够存储程序的外围部件，但开发成本较高。需要注意，有一些电脑有非官方BIOS固件，植入后门相当简单。","date":"2020-03-05","agreeCount":10,"discussionCount":0}