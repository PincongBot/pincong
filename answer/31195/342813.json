{"type":"answer","id":342813,"parentType":"question","parentId":31195,"uid":33152,"contents":"<pre>import time<br>\nfrom pathlib import Path<br>\nfrom base64 import b64encode<br>\nimport requests<br>\n<br>\nSUFFIX_IMG = [\".jpeg\", \".png\", \".gif\", \".jpg\"]<br>\nURL = \"https://api.imgur.com/3/image\"<br>\nDIRPIC = \"/home/you/pic\"<br>\nCID = \"Client-ID 98cd21cdfc58130\"<br>\n<br>\n<br>\ndef upload(filepath, url_imgur, cid):<br>\n&nbsp; &nbsp; time.sleep(0.5)<br>\n&nbsp; &nbsp; with open(filepath, \"r\") as f:<br>\n&nbsp; &nbsp; &nbsp; &nbsp; result = requests.post(<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; url_imgur,<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; headers={\"Authorization\": cid},<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data={\"image\": b64encode(f.read()), \"type\": \"base64\"},<br>\n&nbsp; &nbsp; &nbsp; &nbsp; ).text<br>\n&nbsp; &nbsp; return result<br>\n<br>\n<br>\ndef extract(text):<br>\n&nbsp; &nbsp; # 我打不开imgur的api页面,不知道返回的是什么<br>\n&nbsp; &nbsp; pass<br>\n<br>\n<br>\ndef get_html(url_imgur, dir_pic, cid, suffix_img):<br>\n&nbsp; &nbsp; return \"\\n\".join(<br>\n&nbsp; &nbsp; &nbsp; &nbsp; [<br>\n    &nbsp; &nbsp; &nbsp; &nbsp;\"方括号img方括号\" + extract(upload(p, url_imgur, cid)) + \"方括号/img方括号\"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for p in Path(dir_pic).iterdir()<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if p.is_file() and p.suffix in suffix_img<br>\n&nbsp; &nbsp; &nbsp; &nbsp; ]<br>\n&nbsp; &nbsp; )<br>\n<br>\n<br>\nprint(get_html(URL, DIRPIC, CID, SUFFIX_IMG))<br>\n<br>\n</pre>","date":"2020-09-19","agreeCount":2,"discussionCount":2}