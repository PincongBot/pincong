{"type":"answer","id":21959,"parentType":"question","parentId":4292,"uid":5356,"contents":"统计了一下品葱在最近7天内共产生了289篇新帖和1711条评论，也就是平均每小时1.71篇新帖，10.1条新评论。<br>\n<br>\n品葱用户分布全球，所以可以假设品葱的流量没有峰值或低谷时段。<br>\n<br>\n如果两条相继到达品葱的消息是独立个体发出的，那么两条消息到达时间的间隔一般服从指数分布。<br>\n<br>\n由前面的粗略的参数估计可以计算出前后两条消息到达时间间隔的分布<br>\n<a href=\"https://i.imgur.com/gFodsG5.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/gFodsG5.png\" alt=\"https://i.imgur.com/gFodsG5.png\" style=\"max-width:100%\"></a><br>\n<br>\n上图可以这么理解，如果前后两条内容是由两个不同的人发出的，那么其出现间隔小于x小时的概率是y.<br>\n<br>\n也就是说<br>\n蓝线：两个不同的人在66分钟内相继发布主贴的概率是10%, 两个不同的人在16小时间隔内相继发布主贴的概率是80%. 所以如果同一个人用不同的小号(或匿名用户)发两篇主贴的间隔是66分钟（16小时），这两个主贴属于同一个人的概率有90%（20%）.<br>\n<br>\n橙线：两个不同的人在12分钟内相继发布评论的概率是10%, 两个不同的人在4小时间隔内相继发布主贴的概率是90%. 所以如果同一个人用不同的小号(或匿名用户)发两条评论的间隔是12分钟（4小时），这两条消息属于同一个人的可能性只有90%（10%）.<br>\n<br>\n前后两条评论的间隔是5分钟的话，属于同一个人的概率高达95%.<br>\n前后两个主贴的间隔是30分钟的话，属于同一个人的概率高达95%.<br>\n<br>\n<b>监控系统的刷新频率</b><br>\n根据目前的流量，要实时监控品葱，每1分钟甚至每5分治刷新一次主页就可以获得的时间分辨度就完全足够识别同一个人了。 对服务器的冲击，如果每分钟一次那每天产生1440次主页请求，如果每5分钟刷新一次每天只产生288次主页请求。SimilarWeb估计新品葱诞生以来平均每月总点击量是一百万，也就是日均总点击量33333。<br>\n<br>\n即便每分钟刷新一次，也只产生不到5%的额外请求。<br>\n<br>\n<b>综上所述</b><br>\n假设你用两个小号发帖，要将两个号之间的关联度降低到20%以下，那么目前流量下发帖延迟的推荐设置为：两次发主帖间隔960分钟，两次发评论的间隔为240分钟。<br>\n<br>\n可能有人要问那么发完主贴再发评论之间的间隔设成多少合适呢？选240分钟吧。<br>\n<br>\n其实我也觉得这个计算不太符合经验，但这些估计本来就是偏保守的，随着将来品葱流量增加，采用这些延迟的实际关联度会更低。","date":"2019-05-20","agreeCount":4,"discussionCount":5}