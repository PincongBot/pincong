{"type":"video_comment","id":17625,"parentType":"video","parentId":1836,"uid":18160,"contents":"@沉默的廣場<br>\n<br>\n<br>\n<br>\n本來不想寫的，但是還是寫點什麽吧。。。<br>\n<br>\n關於KCP，看代碼<br>\nv2ray-core\\transport\\internet\\kcp\\io.go<br>\n這一個文件，就足夠了<br>\n<br>\n注意到<br>\nfunc (r *KCPPacketReader) Read(b []byte) []Segment {<br>\n和<br>\nfunc (w *KCPPacketWriter) Write(b []byte) (int, error) {<br>\n兩個函數<br>\n<br>\n<br>\n我們可以知道，協議格式如下<br>\n報文頭+payload<br>\n<br>\n報文頭，是根據header配置，可以配置DTLS，wireguard。。。增加僞裝<br>\npayload，用異或加密了。。。<br>\n<br>\n因爲加密了，所以看不出kcp【24字節】或者mkcp【18字節】的報文頭<br>\n<br>\n擧個例子，如果配置如下<br>\n<pre>&nbsp; &nbsp; &nbsp; \"streamSettings\": {<br>\n&nbsp; &nbsp; &nbsp; &nbsp; \"network\": \"mkcp\", //此处的 mkcp 也可写成 kcp，两种写法是起同样的效果<br>\n&nbsp; &nbsp; &nbsp; &nbsp; \"kcpSettings\": {<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"uplinkCapacity\": 5,<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"downlinkCapacity\": 5,<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"congestion\": true,<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"header\": {<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"type\": \"dtls\"<br>\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>\n&nbsp; &nbsp; &nbsp; &nbsp; }<br>\n&nbsp; &nbsp; &nbsp; }</pre><br>\n<br>\n所以，最終報文就是 <br>\nDTLS頭 + payload<br>\n<br>\n<br>\n===========分割綫===============<br>\n默認的代碼，當然很好破解，對所有的udp流量，執行<br>\nv2ray-core\\transport\\internet\\kcp\\xor.go文件<br>\n裏的xorbkd函數，不管你怎麽僞裝都是明文流量。。。<br>\n<br>\n<br>\n我的意思，特別簡單，你只要<b>自己修改xor.go的xorfwd，xorbkd兩個函數</b>就可以了~<br>\n因爲共產黨不知道你怎麽加密流量，所以沒法有針對破解！<br>\n這樣，你代碼量最小，卻效益最大！！！【只改了一個文件的兩個函數】<br>\n<br>\n重點：<br>\n<pre>&nbsp; \"uplinkCapacity\": 5,<br>\n&nbsp; \"downlinkCapacity\": 5,</pre><br>\n<br>\n這兩個配置項不可以太大，UDP碼率太高，必然是翻墻。沒有其他可能。。。<br>\n<br>\n舉個例子，MP3碼率是128Kbps，B站的1080p視頻，碼率是6Mbps<br>\n所以，你udp碼率達到10Mbps以上是不正常的<br>\n<br>\n我建議是2Mbps就已經是極限了，超過這個數值，很大程度是翻墻。其實2Mbps，我覺得網速足夠了","date":"2020-05-01","agreeCount":0,"discussionCount":0}