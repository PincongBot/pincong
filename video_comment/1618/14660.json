{"type":"video_comment","id":14660,"parentType":"video","parentId":1618,"uid":44379,"contents":"<center><b>暗网架站 (2.2)安装Tor &amp; 搭建hidden service</b></center><br>\n安装Tor：<br>\n<pre>pkg_add tor</pre><br>\n建立目录，放置Tor网站的私钥，同时设置权限：<br>\n<pre>mkdir -p /var/lib/tor/hidden_service<br>\nchmod 700 -R /var/lib/tor/hidden_service<br>\nchown -R _tor:_tor /var/lib/tor/hidden_service<br>\n</pre><br>\nTor网站不需要IP或者域名，它用一个随机生成的hash来唯一标识。能唯一控制这个域名的就是hash对应的私钥，因此必须保管好私钥，如果私钥泄露即丧失了对暗网域名的控制权。<br>\n<br>\n然后编辑/etc/tor/torrc文件，在其中添加以下内容：<br>\n<pre>Socks5Proxy 127.0.0.1:10086<br>\nSocksPort 0<br>\n<br>\nHiddenServiceDir /var/lib/tor/hidden_service/<br>\nHiddenServicePort 80 192.168.89.12:80<br>\nHiddenServiceVersion 2<br>\nHiddenServiceMaxStreams 10<br>\nHiddenServiceMaxStreamsCloseCircuit 1<br>\nHiddenServiceNumIntroductionPoints 10</pre><br>\n需要注意的是HiddenServiceVersion这一行，tor有第二代和第三代两种协议可选，第三代Tor协议隐蔽性更好，可以抗流量分析，同时使用更强的加密算法（二代Tor协议只使用RSA1024），此外还支持客户端验证功能。唯一的“缺点”是.onion域名有56位，比较长。OpenBSD上Tor安装好以后默认使用第三代协议，即<br>\n<pre>HiddenServiceVersion 3</pre><br>\n如果这一栏取3，则tor会在hidden_service目录下生成私钥和你的域名，域名保存在hostname文件中，输入<br>\n<pre>cat /etc/lib/tor/hidden_service/hostname</pre><br>\n可以查看域名。<br>\n<br>\n<u>这里为了方便自定义域名前缀，使用较弱的第二代协议。</u>","date":"2020-04-04","agreeCount":4,"discussionCount":0}