{"type":"video_comment","id":14616,"parentType":"video","parentId":1618,"uid":20551,"contents":"<center><b>暗网架站 (1) </b></center><br>\n本文讲解搭建双虚拟机隔离Web服务和Tor，架设暗网网站的方法。<br>\n<br>\n暗网架站的好处：<br>\n<ul><li>不会暴露服务器IP：服务器有至少三层Tor中继做代理保护。相比之下，明网网站只能用CDN隐藏IP，如果CDN厂商被收买/爆出漏洞，服务器源IP就有暴露的危险。网站用CDN和Tor的安全性差别，可以类比于客户端用商业VPN和Tor的差别。</li><li>不会暴露访问者IP：客户端访问暗网网站也要经过三层中继。算上服务的三层中继，任何tor客户端到服务器之间都有6个Tor节点保护，因此服务器和客户端互相不知道对方身份。具体原理可以见：<a href=\"https://community.torproject.org/onion-services/overview/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">How do onion services work</a></li><li>架站方便，成本非常低：Tor可以穿透NAT，所以暗网不需要申请域名和公网IP，家用宽带就可以建网站。网站可以架在PC/上网本/树莓派上，可以利用家里的废旧电脑建暗网网站。</li><li>流量加密：Tor网络自带端到端加密，并且抗中间人攻击，不需要HTTPS。</li></ul><br>\n<br>\n双虚拟机架站能极大地减小Web服务端泄露IP的风险（Application level leaks）。原理和<a href=\"https://program-think.blogspot.com/2015/04/howto-cover-your-tracks-8.html\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">双虚拟机隔离上网</a>一样：【服务器虚拟机】里安装Web服务端，【网关虚拟机】里安装Tor和代理客户端，网络拓扑如下所示。<br>\n<pre>|--------------|<br>\n|&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br>\n|&nbsp; Web Server |&nbsp; &nbsp; Web Server ==&gt; 192.168.89.12:80<br>\n|&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |<br>\n|--------------|<br>\n&nbsp; &nbsp; |<br>\n&nbsp; &nbsp; |&nbsp; Internal [192.168.89.12:80]<br>\n&nbsp; &nbsp; |<br>\n&nbsp; &nbsp; |&nbsp; Internal [192.168.89.64:80]<br>\n&nbsp; &nbsp; |<br>\n|--------------|<br>\n|&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |&nbsp; &nbsp; 192.168.89.64:80 ==&gt; tor<br>\n| Tor Gateway  |&nbsp; &nbsp; tor ==&gt; 127.0.0.1:10086<br>\n|&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; |&nbsp; &nbsp; 127.0.0.1:10086 ==&gt; V2Ray<br>\n|--------------|&nbsp; &nbsp; V2Ray ==&gt; Internet<br>\n&nbsp; &nbsp; &nbsp;|<br>\n&nbsp; &nbsp; &nbsp;|<br>\n&nbsp; &nbsp; &nbsp;|<br>\n&nbsp; &nbsp; Internet</pre><br>\n搭建暗网网站是高风险操作。为了防止【单点故障】的风险，建议【网关虚拟机】和【服务器虚拟机】用不同的操作系统。为了减小攻击面，操作系统应该尽量精简，安装时选择【极小安装】。为了防止【虚拟机穿透】，按照楼上上上的方法，关掉虚拟机不用的功能。<br>\n<br>\n软件选择：<br>\n网关虚拟机：推荐Debian，<s>CentOS</s>，*BSD系列，Alpline Linux，OPNsense(@Resistance 补充)。极小安装下配置单核CPU，512MB内存，1.5GB硬盘即可。<br>\nWeb服务器虚拟机：同上<br>\nWeb服务器软件：根据<a href=\"https://www.whonix.org/wiki/Onion_Services#Web_Server_Software_Recommendations\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">安全专家的意见</a>，Apache漏洞太多，Web服务器推荐Nginx。","date":"2020-04-03","agreeCount":3,"discussionCount":0}