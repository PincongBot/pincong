{"type":"article","id":2638,"title":"【High Priority】评论/回答折叠功能（半竣工）","uid":8132,"topics":[],"contents":"<a href=\"https://github.com/orgs/pin-cong/teams/pincong-developer-committee/discussions/4\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">Original_Link</a><br>\n<b><i>This discussion concerns the function \"评论/回答折叠\", for any discussion related to this, please follow up under this thread.</i></b><br>\n<b>The whole discussion was written in English for developers convenience. For Chinese accessibility, please use&nbsp;<a href=\"https://translate.google.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">Google translate</a>.</b><br>\n本功能已经暂时完成，但仍需完善。<br>\n<s>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</s><br>\n<b>中文描述：目前折叠只有一个理由，需要更多理由来帮助建立五毛样本库</b><br>\n<s>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</s><br>\n<b>Before starting</b>:<br>\n<ol><li>Read <u>fold_reply()</u> function in \"<a href=\"https://github.com/pincong/pincong-wecenter/blob/master/models/content.php\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">pincong-wecenter/models/content.php</a>\"，and see how folding an answer/comment works on the backend.</li><li>Read \"<a href=\"https://github.com/pincong/pincong-wecenter/blob/master/views/default/article/index.tpl.htm\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">pincong-wecenter-master/views/default/article/index.tql.htm</a>\" (for example), search for keyword&nbsp;<i>['fold']</i>, and see how folding works on the frontend</li><li>Look at&nbsp;<u>why_fold()&nbsp;</u>function in \"<a href=\"https://github.com/pincong/pincong-wecenter/blob/master/static/js/aws.js\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">pincong-wecenter-master/static/js/aws.js</a>\".</li></ol><br>\n<s>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</s><br>\n<b>TODO List Summary:</b><br>\n<ol><li><s>Add a new table, recording all folding type (i.e, whether it's an answer, a comment etc.), folding item_id, and folding reason (better to&nbsp;<i>&lt;select&gt;</i>&nbsp;be a&nbsp;tag) and the id of the folding admin.</s> The column database was already modified for this function. Current code for folding is:<ul><li>Current code in use:</li>1: 账号被封禁（或被手动折叠）</ul><ul>2: 踩数过多没有帮助<li>Hypothetical code:</li>3: 无关回答/评论</ul><ul>4: 谩骂、侮辱</ul><ul>5: 刷屏、扰乱秩序</ul></li><li><s>Add a new ajax function for submitting folding request.</s></li><li>Add folding reason (the number) to the item.</li><li>Modify&nbsp;<u>why_fold()</u>function to show the folding reason.</li></ol><br>\n<s>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</s><br>\n<b>TODO List (PHP Code):</b><br>\n[<a href=\"https://github.com/pincong/pincong-wecenter/blob/master/models/content.php\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">pincong-wecenter/models/content.php</a>]<br>\nChange the function <u>fold_reply</u>, adding extra argument for folding reason, and change the number of folding accordingly. <br>\n[<a href=\"https://github.com/pincong/pincong-wecenter/blob/master/app/content/ajax.php\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">pincong-wecenter/app/content/ajax.php</a>]<br>\n<ul><li>Edit function <u>fold_reply_action</u>() to recieve the folding reason in <i>$_POST</i>.</li></ul><br>\n<s>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</s><br>\n<b>TODO List (HTML/JS Code):</b><br>\n<b>For simplicty, we only described the procedure for article. Should be the same for answer and vidoe comment</b><br>\n[<a href=\"https://github.com/pincong/pincong-wecenter/blob/master/views/default/article/index.tpl.htm\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">pincong-wecenter-master/views/default/article/index.tql.htm</a>]<br>\nAdd the <i>['fold']</i> id to function <u>AWS.User.why_fold</u>().<br>\n<u>[<a href=\"https://github.com/pincong/pincong-wecenter/blob/master/static/js/aws.js\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">pincong-wecenter-master/static/js/aws.js</a>]</u><br>\n<ol><li>Edit the function <u>why_fold</u>() to display the folding reason correctly.</li><li>Add a new function <u>fold_comment</u> with the right UI, please see function <u>forbid_user</u> for refrence. Change the <i>textBox</i> to <i>dropDown</i>.</li></ol><br>\n<s>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</s><br>\nPlease post any question you may have. We probably will encouter more issues while editing. Don't hesitate to follow up your problems. Thanks and happy coding!","date":"2019-07-27","agreeCount":8,"discussionCount":0}