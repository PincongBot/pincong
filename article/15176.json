{"type":"article","id":15176,"title":"免翻墙上品葱教程(DoH+ESNI直连)","uid":20551,"topics":[153,112,249,6222],"contents":"<b>安全提示：本文介绍的方法只作为临时手段。如果打算长期活动，一定要挂代理。如果要从事高风险活动，请使用VPN+Tor。</b><br>\n<br>\n截至2020年初，防火墙封杀网站的手段有：<br>\n<br>\n<ul><li>关键词过滤：随着https的普及，这种方法已经不常见。</li><li>封锁IP：主要用来屏蔽Google，Facebook等IP地址固定的大型网站。</li><li>DNS污染+SNI探测：IPv4地址资源有限，对绝大多数网站，防火墙只能用DNS污染封锁。改Host可以绕过封锁，也可以用本文的DoH+ESNI方法直连被墙网站。</li></ul><br>\n<br>\nDoH+ESNI直连翻墙的稳定性非常高，DoH+ESNI可以看作是加密的DNS，和隐藏服务器名字的HTTPS。开启DoH+ESNI后，防火墙无法知道你在访问哪个网站，墙唯一知道的就是你的IP和你要访问的IP。<br>\n<br>\n品葱使用Cloudflare作安全防护，使用本文的方法直连品葱，防火墙只能检测到你在访问Cloudflare IP，没法知道你在访问品葱。而品葱本身不记录访客IP地址，除非品葱网站被渗透，不存在任何暴露IP的可能性。<br>\n<br>\n使用Cloudflare的网站（比如品葱），GFW只能封锁域名，无法彻底封杀IP地址。全世界有半数网站在使用Cloudflare，如果GFW一刀切封杀所有Cloudflare IP，相当于实行事实上的白名单。<br>\n<br>\nDoH是DNS over HTTPS的缩写，ESNI是Encrypted Server Name Indication（加密服务器名称指示）。进一步了解DoH和ESNI可以参考：<br>\n<br>\n维基百科：<a href=\"https://zh.wikipedia.org/zh-hans/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%8D%E7%A7%B0%E6%8C%87%E7%A4%BA\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">服务器名称指示</a><br>\n维基百科：<a href=\"https://zh.wikipedia.org/wiki/DNS_over_HTTPS\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">DNS over HTTPS</a><br>\nSSPai：<a href=\"https://sspai.com/post/56783\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">想要上网体验有保障，如何设置一个更安全的 DNS？</a>（墙内网站）<br>\n<br>\n目前（2020年初）支持DoH+ESNI的浏览器只有Firefox，下面讲如何在Firefox上开启DoH和ESNI。<br>\n<br>\n下载火狐浏览器，注意不要用中国版火狐。用国产搜索引擎找Firefox会跳转到火狐中国版。<br>\nFirefox官网下载（Mozilla基金会）<br>\n<a href=\"https://www.mozilla.org/zh-CN/firefox/new/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://www.mozilla.org/zh-CN/firefox/new/</a><br>\n<br>\n直接下载链接（中文版，64位Windows）<br>\n<a href=\"https://download.mozilla.org/?product=firefox-msi-latest-ssl&amp;os=win64&amp;lang=zh-CN\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://download.mozilla.org/?product=firefox-msi-latest-ssl&amp;os=win64&amp;lang=zh-CN</a><br>\n<br>\n直接下载链接（中文版，64位macOS）<br>\n<a href=\"https://download.mozilla.org/?product=firefox-latest-ssl&amp;os=osx&amp;lang=zh-CN\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://download.mozilla.org/?product=firefox-latest-ssl&amp;os=osx&amp;lang=zh-CN</a><br>\n<br>\n<br>\n【1】安装好Firefox后，点右上角的菜单按钮（画红圈处），在弹出菜单里点击【选项】。<br>\n<a href=\"https://i.imgur.com/YdaRtpQ.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/YdaRtpQ.png\" alt=\"https://i.imgur.com/YdaRtpQ.png\" style=\"max-width:100%\"></a><br>\n<br>\n<br>\n【2】在选项页面里向下拉到底，可以看见【网络设置】，点击【设置】按钮。<br>\n<a href=\"https://i.imgur.com/84c2xO6.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/84c2xO6.png\" alt=\"https://i.imgur.com/84c2xO6.png\" style=\"max-width:100%\"></a><br>\n<br>\n<br>\n【3】在弹出的【连接设置】页面里，继续拉到底，勾选【启用基于HTTPS的DNS】选项。下面默认的提供商应当是Cloudflare。<br>\n<a href=\"https://i.imgur.com/vGwtf1Q.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/vGwtf1Q.png\" alt=\"https://i.imgur.com/vGwtf1Q.png\" style=\"max-width:100%\"></a><br>\n<br>\n<br>\n<b>到这里DoH就设置完成了，接下来设置ESNI。</b><br>\n<br>\n<br>\n【4】在Firefox的地址栏里输入about:config，回车，如图<br>\n<a href=\"https://i.imgur.com/JzXWTCm.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/JzXWTCm.png\" alt=\"https://i.imgur.com/JzXWTCm.png\" style=\"max-width:100%\"></a><br>\n<br>\n<br>\n【5】接下来可以看到警告提示，点【接受风险并继续】就可以。<br>\n<a href=\"https://i.imgur.com/ck36sJX.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/ck36sJX.png\" alt=\"https://i.imgur.com/ck36sJX.png\" style=\"max-width:100%\"></a><br>\n<br>\n<br>\n<br>\n【6】在高级首选项里，在画红色方框的地方输入esni，如图<br>\n<a href=\"https://i.imgur.com/rs1xtOO.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/rs1xtOO.png\" alt=\"https://i.imgur.com/rs1xtOO.png\" style=\"max-width:100%\"></a><br>\n<br>\n<br>\n【7】弹出的设置如下，默认情况下，“network.security.esni.enabled”选项为false。点一下红圈圈住的按钮，让这个选项变成“true”就可以了。设置好以后如下图<br>\n<a href=\"https://i.imgur.com/dtLePoq.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/dtLePoq.png\" alt=\"https://i.imgur.com/dtLePoq.png\" style=\"max-width:100%\"></a><br>\n<br>\n<br>\n【8】接下来就可以免翻墙上品葱了<br>\n<a href=\"https://i.imgur.com/kKd5i5H.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/kKd5i5H.png\" alt=\"https://i.imgur.com/kKd5i5H.png\" style=\"max-width:100%\"></a><br>\n以上是电脑配置直连的方法，再说下<b>手机端直连品葱的方法。</b><br>\n<br>\n手机直连品葱只能用Firefox浏览器，APK下载地址：<br>\n<a href=\"https://apkpure.com/cn/firefox-browser-fast-private-safe-web-browser/org.mozilla.firefox/download?from=details\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://apkpure.com/cn/firefox-browser-fast-private-safe-web-browser/org.mozilla.firefox/download?from=details</a><br>\n<br>\n【1】地址栏输入：<br>\n<pre>about:config</pre><br>\n<br>\n【2】下面的选项搜索框里，输入：<br>\n<pre>network.trr.mode</pre><br>\n把这个选项的值改成2，打开DoH.<br>\n默认值是0，表示不启用。2表示启用DoH并把常规DNS作为后备（推荐）。<br>\n<br>\n【3】选项搜索框里，输入：<br>\n<pre>network.security.esni.enabled</pre><br>\n把这个选项的值改成true，打开ESNI.<br>\n<br>\n然后就可以用手机直连品葱了。<br>\n<br>\n---------------------------<br>\n只要浏览器是Firefox，配置了Cloudflare的网站都可以用DoH+ESNI直连，目前已知有效的有：<br>\n<br>\n品葱 <br>\n<a href=\"https://pincong.rocks\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://pincong.rocks</a><br>\n<br>\nMatters<br>\n<a href=\"https://matters.news\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://matters.news</a><br>\n<br>\nMedium <br>\n<a href=\"https://medium.com\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://medium.com</a><br>\n<br>\n编程随想的博客（镜像）<br>\n<a href=\"https://program-think-mirror.github.io/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://program-think-mirror.github.io/</a><br>\n<br>\n来自其它网友补充：<br>\n郭媒体<br>\n<a href=\"https://gnews.org/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://gnews.org/</a><br>\n<br>\n中国数字时代<br>\n<a href=\"https://chinadigitaltimes.net/chinese/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://chinadigitaltimes.net/chinese/</a><br>\n<br>\nDuckDuckGo<br>\n<a href=\"https://duckduckgo.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://duckduckgo.com/</a><br>\n<br>\nSlashDot（IT技术）<br>\n<a href=\"https://slashdot.org\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://slashdot.org</a><br>\n<br>\n自由微博<br>\nhttps://freeweibo.com<br>\n<br>\nGreatfire<br>\n<a href=\"https://zh.greatfire.org/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://zh.greatfire.org/</a><br>\n<br>\n可能吧（一个中文博客站）<br>\n<a href=\"https://kenengba.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://kenengba.com/</a><br>\n<br>\nGitHub(开启DoH后可以提速)<br>\n<a href=\"https://github.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://github.com/</a><br>\n<br>\n欢迎补充。<br>\n<br>\n最后一点安全守则：<br>\n<br>\n<ul><li>只浏览不发言的用户，可以用本文方法浏览品葱。</li><li>新用户可以用这种方法临时上品葱，再寻找其它翻墙手段。</li><li>经常登录发言的用户，最低标准是外资VPN/VPS，推荐使用VPN+Tor。</li><li>在墙内网站冲塔，号召行动，必须使用干净电脑+虚拟机+Tor</li></ul>","date":"2020-02-26","agreeCount":185,"discussionCount":0}