{"type":"article","id":12680,"title":"【科普】厉害国的“大炮”网络攻击工具","uid":24216,"topics":[5829,2600,3474,5830],"contents":"<b>大炮</b>（英语：Great Cannon）是<a href=\"https://zh.wikipedia.org/wiki/%E4%B8%AD%E8%8F%AF%E4%BA%BA%E6%B0%91%E5%85%B1%E5%92%8C%E5%9C%8B\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">中华人民共和国</a>的<a href=\"https://zh.wikipedia.org/wiki/%E7%B6%B2%E8%B7%AF%E6%88%B0\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">网络攻击</a>工具的名称，借由拦截大量网络流量，对特定目标网站发动<a href=\"https://zh.wikipedia.org/wiki/%E5%88%86%E6%95%A3%E5%BC%8F%E9%98%BB%E6%96%B7%E6%9C%8D%E5%8B%99%E6%94%BB%E6%93%8A\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">分布式拒绝服务攻击</a>（DDoS）。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-NYT-China-Said-to-Use-Powerful-New-Weapon-Censor-Internet-1\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[1]</a><a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-BBC中文網-2\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[2]</a><a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-3\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[3]</a>其中除了网络攻击，还曾对<a href=\"https://zh.wikipedia.org/wiki/%E7%AA%81%E7%A0%B4%E7%BD%91%E7%BB%9C%E5%AE%A1%E6%9F%A5\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">翻墙</a>技术讨论网站进行攻击，阻止相关加密技术交流开发。<br>\n<br>\n<b>主要技术</b><br>\n<br>\n根据命名大炮的加拿大学者表示，大炮将从中国以外的连线流量导到特定的目标网站，导致目标网站网络服务不稳。虽然大炮跟<a href=\"https://zh.wikipedia.org/wiki/%E9%98%B2%E7%81%AB%E9%95%B7%E5%9F%8E\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">防火长城</a>一起，但大炮是分开的攻击系统，拥有不同的设计和功用。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-China-Great-Cannon-4\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[4]</a>除了发起分布式拒绝服务攻击以外，大炮还能监控<a href=\"https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">网络流量</a>，以及采用类似<a href=\"https://zh.wikipedia.org/wiki/%E7%BE%8E%E5%9C%8B%E5%9C%8B%E5%AE%89%E5%B1%80\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">美国国安局</a>的<a href=\"https://zh.wikipedia.org/w/index.php?title=%E9%87%8F%E5%AD%90%E6%B3%A8%E5%85%A5%E7%B3%BB%E7%B5%B1&amp;action=edit&amp;redlink=1\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">量子注入系统</a>（Quantum insert system），对目标散布<a href=\"https://zh.wikipedia.org/wiki/%E6%83%A1%E6%84%8F%E7%A8%8B%E5%BC%8F\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">恶意程序</a>。<br>\n<br>\n<b>大炮发起的攻击</b><br>\n大炮的第一个目标可能是存储避开网络审查工具的网站，像是在线源代码存储网站<a href=\"https://zh.wikipedia.org/wiki/GitHub\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">GitHub</a>，以及监控中国防火长城屏蔽现况的<a href=\"https://zh.wikipedia.org/wiki/GreatFire\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">GreatFire</a>网站。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-WSP-China-Deploys-New-Weapon-Online-Censorship-Great-Cannon-7\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[7]</a>多次技术报告显示，发动对GitHub和GreatFire的攻击的方式是通过向<a href=\"https://zh.wikipedia.org/wiki/%E7%99%BE%E5%BA%A6\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">百度</a>注入恶意的<a href=\"https://zh.wikipedia.org/wiki/JavaScript\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">JavaScript</a>（简称JS）代码以使从中国大陆以外访问百度网站及广告的流量转换为DDoS攻击发送至目标。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-8\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[8]</a><br>\n<br>\n<b>针对Github</b><br>\n2015年3月26日至31日借由<a href=\"https://zh.wikipedia.org/wiki/%E6%97%81%E8%A7%82%E8%80%85%E6%94%BB%E5%87%BB\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">旁观者攻击</a>（英语：Man-on-the-side attack）技术对<a href=\"https://zh.wikipedia.org/wiki/GitHub\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">GitHub</a>发起的网络攻击，被认为是大炮的第一次重要应用。<br>\n<br>\n第三方研究者指出，此次攻击采用了HTTP劫持，<a href=\"https://zh.wikipedia.org/wiki/%E7%99%BE%E5%BA%A6\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">百度</a>的<a href=\"https://zh.wikipedia.org/wiki/JavaScript\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">JS脚本文件</a>被<a href=\"https://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">中间人</a>植入了攻击GitHub的代码，其功能是每隔2秒加载一次<a href=\"https://zh.wikipedia.org/wiki/Greatfire.org\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">GreatFire</a>或<a href=\"https://zh.wikipedia.org/wiki/%E7%BA%BD%E7%BA%A6%E6%97%B6%E6%8A%A5\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">纽约时报中文网</a>的账号主页。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-9\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[9]</a>百度已否认自身产品存在安全问题。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-10\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[10]</a>。这次攻击导致GitHub在全球范围内的访问速度下降。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-11\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[11]</a>外界普遍相信这是中国政府所为，但中国政府予以否认。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-iThome.com.tw-12\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[12]</a> <a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-13\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[13]</a> 3月28日（<a href=\"https://zh.wikipedia.org/wiki/UTC%2B8\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">UTC+8</a>）起，GitHub在中国大陆十分不稳定，多数情况下无法访问。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-14\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[14]</a>截止29日，攻击者共使用了四种DDoS攻击技术：<br>\n<br>\n<ol><br>\n<li>第一轮，利用中国大陆以外的网民与<a href=\"https://zh.wikipedia.org/wiki/%E7%AA%81%E7%A0%B4%E7%B6%B2%E8%B7%AF%E5%AF%A9%E6%9F%A5\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">翻墙</a>的网民浏览被劫持的百度JavaScript文件，该文件每2秒向GitHub上的两个页面发出请求，被GitHub的弹窗警告拦住；</li><br>\n<li>第二轮，跨网域&lt;img&gt;攻击，被GitHub检查<a href=\"https://zh.wikipedia.org/w/index.phptitle=Referer&amp;action=edit&amp;redlink=1\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">Referer</a>拦住；</li><br>\n<li>第三轮，DDoS攻击<a href=\"https://zh.wikipedia.org/wiki/GitHub_Pages\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">GitHub Pages</a>；</li><br>\n<li>第四轮，<a href=\"https://zh.wikipedia.org/wiki/SYN_flood\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">SYN flood</a>，利用<a href=\"https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">TCP</a>缺陷发送大批伪造的TCP连线请求，耗尽GitHub的资源。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-15\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[15]</a></li><br>\n</ol><br>\n根据系统状态消息页面的显示，已于3月31日停止了网络攻击，该日凌晨0:09（UTC）已经稳定。GitHub在其Twitter与微博予以了证实。至此，此网络攻击共持续了五天。<br>\n<br>\n<b>其他</b><br>\n2015年4月26日，大炮对开放源代码网站wpkg.org与旅游网站ptraveler.com发动了攻击，凡是用中国IP浏览嵌入了Facebook Connect按钮脚本的网站，皆会被重定向至这两个网站。<br>\n<br>\n2017年8月16日，大炮被发现攻击曾经邀请中国海外流亡富豪<a href=\"https://zh.wikipedia.org/wiki/%E9%83%AD%E6%96%87%E8%B4%B5\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">郭文贵</a>做访谈的异议新闻站点<a href=\"https://zh.wikipedia.org/wiki/%E6%98%8E%E9%95%9C%E6%96%B0%E9%97%BB%E9%9B%86%E5%9B%A2\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">明镜网</a>，大炮通过对百度站长统计的脚本代码注入攻击明镜网的代码。 <br>\n<br>\n2019年12月初，美国网络服务提供商<a href=\"https://zh.wikipedia.org/wiki/AT%26T%E5%85%AC%E5%8F%B8\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">AT&amp;T公司</a>下属的网络安全实验室发表研究报告指出，自11月25日起，“大炮”被重新部署以攻击被认为与香港<a href=\"https://zh.wikipedia.org/wiki/%E5%8F%8D%E5%B0%8D%E9%80%83%E7%8A%AF%E6%A2%9D%E4%BE%8B%E4%BF%AE%E8%A8%82%E8%8D%89%E6%A1%88%E9%81%8B%E5%8B%95\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">反对逃犯条例修订草案运动</a>有关的网络论坛<a href=\"https://zh.wikipedia.org/wiki/LIHKG%E8%A8%8E%E8%AB%96%E5%8D%80\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">LIHKG讨论区</a>及多个其它意义不明的网络目标。该报道亦提及，早在8月31日，“大炮”就曾对LIHKG讨论区发起攻击。而有关程序代码与2017年明镜新闻网所受攻击中的代码极为相似。<a href=\"https://zh.wikipedia.org/zh-cn/%E5%A4%A7%E7%82%AE_(%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%B7%A5%E5%85%B7)#cite_note-22\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">[22]</a><br>\n<br>\n<b>如何认定与中国政府有关</b><br>\n<a href=\"https://zh.wikipedia.org/wiki/File:Traceroute-GFW.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><a href=\"https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/Traceroute-GFW.png/220px-Traceroute-GFW.png\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/Traceroute-GFW.png/220px-Traceroute-GFW.png\" alt=\"https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/Traceroute-GFW.png/220px-Traceroute-GFW.png\" style=\"max-width:100%\"></a></a><br>\n<br>\n使用<a href=\"https://zh.wikipedia.org/wiki/Traceroute\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">Traceroute</a>追踪<a href=\"https://zh.wikipedia.org/wiki/%E5%AD%98%E6%B4%BB%E6%99%82%E9%96%93\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">TTL</a>来证明中国政府对GitHub发动攻击<br>\n为了防止数据在网络中无限循环，名为<a href=\"https://zh.wikipedia.org/wiki/%E5%AD%98%E6%B4%BB%E6%99%82%E9%96%93\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">存活时间</a>（Time to live，TTL）的机制限定了数据包的寿命。从数据包发出开始，每经过一个路由，TTL就减去1，当TTL=0时数据包将会被丢弃。大多数系统发送数据包时都是从TTL=64开始，如果该数据包抵达时TTL=24，那么计算机和发送者之间经过了40跳（64-24=40）。在对GitHub发动的DDoS攻击中，攻击者劫持了<a href=\"https://zh.wikipedia.org/wiki/%E7%99%BE%E5%BA%A6\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">百度</a>的JS文件。如图所示，百度<a href=\"https://zh.wikipedia.org/wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">服务器</a>所发送数据包的TTL=64，第一次抵达用户<a href=\"https://zh.wikipedia.org/wiki/%E6%B5%8F%E8%A7%88%E5%99%A8\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">浏览器</a>时TTL=42，经过了22跳，用户发回的请求包的TTL值也是64，但接下来的响应包的TTL值却突然变成了227，显然有中间人设备注入了伪造包。一位研究人员用定制<a href=\"https://zh.wikipedia.org/wiki/Traceroute\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">Traceroute</a>工具测试发现，注入设备位于第11跳和第12跳之间，通过查询第12跳设备的IP地址，作者发现它位于中国联通骨干网，因此得出了中国政府与此有关的结论。<br>\n<br>\n<b>Google对JS劫持攻击的分析</b><br>\n2015年4月24日，Google安全团队在其博客撰文称，Javascript劫持攻击的执行分为多个阶段，最早发生在2015年3月3日，最后一次是在4月7日。Google指出，共有8个百度网域遭到劫持，被注入不同大小的Javascript代码。Google认为，全面启用HTTPS加密将能防御这类攻击。<br>\n<br>\n<b>观点</b><br>\n加州大学伯克利分校研究生比尔·马尔切克认为，一些中国国内网站，如百度被“大炮”截获数据用以进行网络攻击，会损害其成为一家全球性竞争企业的机会。<br>\n<br>\n<br>\n<br>\n近期品葱遭受攻击，很有可能又是大炮在搞鬼。","date":"2020-01-22","agreeCount":12,"discussionCount":0}