{"type":"article","id":18939,"title":"【霏艺所思】Cloudflare的ngx_brotli_module压缩模块","uid":18160,"topics":[9007],"contents":"Cloudflare下的开源项目精华真多<br>\nhttps://github.com/cloudflare/ngx_brotli_module<br>\n这个，我觉得就可以很适合初学者入门nginx 的module开发<br>\n<br>\n整个开源项目 ，就一个代码文件 <b>ngx_http_brotli_filter_module.c</b><br>\n<br>\n入口函数 叫 <b>ngx_http_brotli_filter_init </b><br>\n给一句忠告 ，一般你自己写mod ，都是从 <b>postconfiguration </b>这个函数指针写起的<br>\n这里用到了 <b>装饰器</b> 设计模式，会python的话，就理解为 @ <br>\n<br>\nngx_http_brotli_header_filter&nbsp; 针对 http的 报文头<br>\n说白了就是修改 Content-Encoding 字段 为 br <br>\n<br>\nngx_http_brotli_body_filter 针对 http的 body<br>\n说白了 就是对原来的body 进行 ngx_http_brotli_filter_compress 压缩<br>\n<br>\n这样，http的body就是br压缩的后的buffer了~","date":"2020-05-16","agreeCount":2,"discussionCount":0}