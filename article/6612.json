{"type":"article","id":6612,"title":"【新排序算法】品葱用户质量排序算法（区分极端和温和用户）","uid":16205,"topics":[153],"contents":"自从小二离开之后，品葱就出现了很多关于下一步的管理和权限的讨论帖。我最近想到一个基于RFM（Recency, Frequency, Monetary Value）的分析模型，所以拿来给品葱试一下。代码是用PHP写的，方便admin直接拿到后台用，也同样给好久没写PHP的自己练下手。PHP代码使用了K-means的<a href=\"https://github.com/bdelespierre/php-kmeans\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">一个库</a>。虽然是1-d的K-means，但不想用其他的算法，所以直接拿现成的来用。因为太长时间没写PHP，手生了所以花了太长时间，现在已经懒得写注释了，有问题直接回帖。<br>\n<br>\nGitHub Repo：<a href=\"https://github.com/ad3be4cf5/Pincong_User_Scoring\" rel=\"nofollow noreferrer noopener\" target=\"_blank\">https://github.com/ad3be4cf5/Pincong_User_Scoring</a><br>\n<br>\n<b>分析模型简要说明：</b><br>\n本算法基于三个因素，分别为：<br>\n<ol><br>\n<li>N天内发言总数。</li><br>\n<li>所有发言总字数。</li><br>\n<li>威望大于1的用户赞踩比。</li><br>\n</ol><br>\n<br>\n1很好理解，就是最近N天内的总体发言数量，包括问题/回答/文章及其评论。2是用户所有的发言的汉字字数总数，这个因子是为了找出那些发长文的用户，可能是因为个人喜欢看长文章吧，毕竟三言两语的灌水帖不会出什么高质量的内容。3是所有点赞和点踩此用户的比例。为防止碰瓷，只把未被封的威望为正（大于1）的用户加入了考虑范围。<br>\n每个因子会使用K-means算法聚类，然后每个用户就会根据这些因子获得一个评分，分越高说明用户质量越高。每个因子都会有一个最高分，最后每个因子的评分都会加起来，作为最终分数。<br>\n<b><br>\n使用例1（寻找和事佬）：</b><br>\n下面我拿两周前（2019年9月30日）备份的数据以及N=14跑了一下目前威望大于64用户的评分。因子最高分（也可以看作是权重）是3-3-5，所以总分最高分为11。为什么我把最后一个权重给这么高，是因为我这个使用例是用来寻找和事佬的。<b>本权重适用于分配威望影响力。</b><br>\n<br>\n<pre>一只鹿兒: 7<br>\n懦夫斯基: 6<br>\nelectron8964: 6<br>\n小钙: 6<br>\n匿名用户: 5<br>\n红冬里的青鱼: 5<br>\n還是小學生: 5<br>\n台湾研究: 5<br>\nInspectorBen: 5<br>\n时代革命: 5<br>\nFreedomAsia: 5<br>\ntony231: 5<br>\n白頭翁: 5<br>\nviewer: 5<br>\nadmin: 5<br>\n小二8964: 5<br>\n陈美丽: 5<br>\n利维坦: 5<br>\n安娜: 4<br>\n币圈奇葩8964: 4<br>\njerry168: 4<br>\n苏维埃督战队: 4<br>\nMerlin: 4<br>\n带带大师兄: 4<br>\n救救孩子: 4<br>\nPracseeuvn: 4<br>\n眼镜娘阿锅: 4<br>\nLuvDDDD: 4<br>\nanonymousLiu: 4<br>\nTashkent: 4<br>\n剑心: 4<br>\n已停用: 4<br>\npc6650: 4<br>\nNakayama: 4<br>\n小汪酱: 4<br>\nkillreddragon: 4<br>\n荣誉非国民: 4<br>\n第三新索多玛: 4<br>\n马拉糕: 4<br>\n赫胥黎: 4<br>\n令狐冲: 4<br>\n天安门上挂维尼: 3<br>\n炎黄子聪: 3<br>\nyichangfeng: 3<br>\n1901zxc已停用: 3<br>\nminwooilbo: 3<br>\n巴巴罗萨: 3<br>\nIzuchisu: 3<br>\nwinkcat: 3<br>\nreppep: 3<br>\nHunter: 3<br>\n组组组组: 3<br>\n经略: 3<br>\nPepperoni: 3<br>\n幹乾干停用: 3<br>\n清水照子: 3<br>\nrtgzddgh: 3<br>\n川普主席万寿无疆: 3<br>\n黑杰克: 3<br>\n书记: 3<br>\nmeta_chaos: 3<br>\nmolecular: 3<br>\n扬子江: 3<br>\nyogafire: 3<br>\n流氓匪首停用: 3<br>\nzhengyi: 3<br>\n说我想说的: 3<br>\n如火如荼: 3<br>\n普习金: 3<br>\n匮名用户: 3<br>\nGogh9836: 3<br>\n精神难民: 3<br>\nrgjdwte: 3<br>\nTseyu: 3<br>\n笔墨写春秋: 3<br>\nHelicopterZ: 3<br>\n蛋蛋很疼: 3<br>\n疯狂习近平: 2<br>\n鸡鸡: 2<br>\n调戏萌新专用号: 2<br>\n路过一下: 2<br>\npincongrocks: 2<br>\nBE4: 2<br>\nNoone: 2<br>\n罗马相册: 2<br>\n地球人: 2<br>\nHenkGao: 2<br>\n支那五毛网评员: 2<br>\nfreedomisours: 2<br>\n自由党人: 2<br>\n我死了: 2<br>\nharmonize: 2<br>\nNNNN: 2<br>\narashi8964: 2<br>\n妙禅师傅: 2<br>\nvvgvv1: 2<br>\nanonym: 2<br>\nburleigh: 2<br>\nEPSON: 2<br>\nikuyui: 2<br>\n鹿晗拳交习近平: 2<br>\n逆流而上的鱼: 2<br>\nchobe: 1<br>\n唵嘛呢叭咪吽: 1<br>\n由比滨结衣: 1<br>\n橘希实香: 1<br>\n民主信仰者: 1<br>\nTetra: 1<br>\n碴条: 1<br>\n月社妃: 1<br>\nAndroid: 1<br>\n我是精赵我骄傲: 1<br>\nRandomID_1: 0<br>\nguibuhai: 0</pre><br>\n根据这个排行榜，我们可以给予得分高于4的用户赞踩影响威望的权限，给予得分在2和4之间的用户半赞踩影响威望权限（也就是两名此类用户一起赞踩才能影响威望），并出于安全考虑取消已回归虚无（得分2以下）的用户的权限。<br>\n<br>\n<b>使用例2（寻找管理员）：<br>\n</b>这个使用例把权重改成了5-3-4，也就是给用户最近活动更多的权重，并下调了赞踩比权重（但还是要有一定权重的，毕竟是管理，不能太具争议性了），此时得到的结果可以用来初步确定管理权限（得分0的用户已排除）。<br>\n<br>\n<pre>懦夫斯基: 6<br>\n一只鹿兒: 6<br>\nelectron8964: 5<br>\n苏维埃督战队: 5<br>\n小钙: 5<br>\n匿名用户: 4<br>\nFreedomAsia: 4<br>\ntony231: 4<br>\n令狐冲: 4<br>\n還是小學生: 4<br>\n小二8964: 4<br>\nadmin: 4<br>\n巴巴罗萨: 3<br>\n小汪酱: 3<br>\n精神难民: 3<br>\n眼镜娘阿锅: 3<br>\n炎黄子聪: 3<br>\nInspectorBen: 3<br>\n时代革命: 3<br>\n天安门上挂维尼: 3<br>\nrtgzddgh: 3<br>\nrgjdwte: 3<br>\nanonymousLiu: 3<br>\n马拉糕: 3<br>\npc6650: 3<br>\n利维坦: 3<br>\nkillreddragon: 3<br>\nIzuchisu: 2<br>\nHelicopterZ: 2<br>\n黑杰克: 2<br>\n幹乾干停用: 2<br>\n已停用: 2<br>\nminwooilbo: 2<br>\n陈美丽: 2<br>\n荣誉非国民: 2<br>\nyichangfeng: 2<br>\nviewer: 2<br>\n带带大师兄: 2<br>\nreppep: 2<br>\n币圈奇葩8964: 2<br>\n红冬里的青鱼: 2<br>\njerry168: 2<br>\n1901zxc已停用: 2<br>\n台湾研究: 2<br>\n组组组组: 2<br>\nPracseeuvn: 2<br>\nLuvDDDD: 2<br>\n经略: 2<br>\n白頭翁: 2<br>\nMerlin: 2<br>\n川普主席万寿无疆: 2<br>\n笔墨写春秋: 2<br>\n说我想说的: 2<br>\nNakayama: 2<br>\nGogh9836: 2<br>\n扬子江: 2<br>\n如火如荼: 2<br>\nTashkent: 2<br>\nmolecular: 2<br>\n蛋蛋很疼: 2<br>\n安娜: 2<br>\nzhengyi: 2<br>\n救救孩子: 2<br>\n流氓匪首停用: 2<br>\n赫胥黎: 2<br>\n剑心: 2<br>\nPepperoni: 1<br>\nikuyui: 1<br>\nharmonize: 1<br>\n鸡鸡: 1<br>\nyogafire: 1<br>\n第三新索多玛: 1<br>\nHunter: 1<br>\n普习金: 1<br>\n清水照子: 1<br>\nwinkcat: 1<br>\nfreedomisours: 1<br>\narashi8964: 1<br>\nvvgvv1: 1<br>\n调戏萌新专用号: 1<br>\n匮名用户: 1<br>\nTseyu: 1<br>\n妙禅师傅: 1<br>\nmeta_chaos: 1<br>\n书记: 1<br>\n路过一下: 1<br>\nEPSON: 1<br>\n逆流而上的鱼: 1</pre><br>\n得分3以上的用户可以给予移动分类、标记甚至超管权限，而得分2和3的用户有正常的封禁权限，其余用户因为活跃量不足，安全起见没有管理权限。<br>\n<br>\n<b>使用例3（推荐关注的高产用户）：<br>\n</b>最后一个使用例把权重改为5-4-2，突出近期产量和质量，因为我们要找的是推荐关注的高产用户，戏剧性较大的（也就是极具争议性的）用户就是我们的首选了，所以最后一个和事佬权重改成了2。这时候让我们看看结果如何吧（得分低于2的用户未显示）。<br>\n<br>\n<pre>匿名用户: 5<br>\n一只鹿兒: 5<br>\n還是小學生: 5<br>\nFreedomAsia: 5<br>\n苏维埃督战队: 4<br>\n懦夫斯基: 4<br>\nrtgzddgh: 4<br>\n小钙: 4<br>\ntony231: 3<br>\n巴巴罗萨: 3<br>\nadmin: 3<br>\nelectron8964: 3<br>\n天安门上挂维尼: 3<br>\n精神难民: 2<br>\n经略: 2<br>\n眼镜娘阿锅: 2<br>\nanonymousLiu: 2<br>\n蛋蛋很疼: 2<br>\n白頭翁: 2<br>\n炎黄子聪: 2<br>\n时代革命: 2<br>\n台湾研究: 2<br>\nInspectorBen: 2<br>\n令狐冲: 2<br>\nTashkent: 2<br>\n如火如荼: 2<br>\npc6650: 2<br>\n红冬里的青鱼: 2<br>\n利维坦: 2<br>\n小二8964: 2<br>\nviewer: 2<br>\n陈美丽: 2<br>\n马拉糕: 2</pre><br>\n可以看到几个极具争议性的“姨粉”光荣上榜，还有一些大家都知道的大V也在上面，说明我们的算法还不赖。<br>\n<br>\n<br>\n当然这三个因子配合不同权重能玩出很多花样，就等admin和开发团队们自己去探索了。关于使用例2，我也有话要说，因为现在备份的数据里没有管理员操作记录，所以这个因素没办法加进去。如果把发言字数替换成管理操作数量的话，就可以使用3-3-3的权重来给用户打分确定管理员权限了。","date":"2019-10-14","agreeCount":20,"discussionCount":0}